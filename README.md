# 競合企業ニュース自動収集・分析システム

## プロジェクト概要

米国競合企業のニュースを自動収集し、AI分析により日本語サマリを生成、Slackに配信するシステムです。COO実務レベルでの情報収集作業を自動化し、スピードとファクトベースの情報提供により、戦略的な意思決定を支援します。

## 主な機能

### 📊 情報収集・分析
- **自動情報収集**: RSS、SNS、Reddit等から競合企業ニュースを自動収集
- **LLM重複排除・統合**: GPT-4による類似記事検出と統合処理、参考リンクとして全ソース表示
- **LLM翻訳**: GPT-4による高品質な日本語翻訳（投稿本文はすべて日本語）
- **LLM分析**: GPT-4によるサマリ生成・重要度判定・カテゴリ分類
- **LLM戦略分析**: GPT-4による週次戦略変更点検出・競合比較分析

### 📱 Slack配信
- **日次レポート**: 件数表示 + 重要度上位10件（リンク付きテキスト）
- **週次レポート**: 各企業の戦略分析と競合比較（日本語）
- **重要度評価**: 100点満点評価（内部処理のみ・表示なし）
- **統合ソース表示**: 複数ソースの参考リンクを一覧表示
- **配信形式**: 本文に重要ニュース、スレッドにその他のニュース

### ⚙️ 管理機能
- **企業管理**: 監視対象企業の登録・編集・削除・一覧表示
- **テスト実行機能**: 情報取得・配信テスト
- **エラー通知設定**: 特定ユーザーへのメンション設定
- **Web管理画面**: Slack認証のみ（権限切り分けなし）

## システム構成

```
[情報源] → [収集API] → [LLM自動統合処理] → [Slack配信]
   ↓           ↓           ↓                ↓
RSS/企業サイト Cloud    GPT-4自動処理      Slack API
Reddit        Functions   システム側設定      日本語統一配信
                       自動重複検出・統合   リンク付きテキスト
                       翻訳・分析
```

### 技術スタック
- **バックエンド**: Google Cloud Functions + Node.js + TypeScript
- **データベース**: Firestore
- **LLM自動統合処理**: OpenAI GPT-4 API (システム側設定による自動処理)
- **配信**: Slack API
- **フロントエンド**: HTML + JavaScript（将来SPAフレームワークに移行予定）
- **ストレージ**: Google Cloud Storage
- **監視**: Cloud Logging
- **セキュリティ**: SecretManager（API キー管理）

## ドキュメント構成

### 📋 [要件定義書](./requirements.md)
- 機能要件・非機能要件の詳細定義
- ユーザーインターフェース仕様
- 運用要件・セキュリティ要件
- 成功指標（KPI）

### 🏗️ [システムアーキテクチャ設計書](./system_architecture.md)
- システム全体構成とコンポーネント詳細
- データフロー・技術スタック
- セキュリティ設計・監視設計
- パフォーマンス最適化・コスト最適化

### 🗄️ [データモデル設計書](./data_model.md)
- Firestoreコレクション設計（LLM統合対応）
- エンティティ関係図・スキーマ定義
- LLM重複排除・統合管理のデータ構造
- インデックス設計・データアクセスパターン
- セキュリティ・データ保持ポリシー

### 🔌 [API仕様書・Slack連携仕様](./api_specifications.md)
- RESTful API仕様（LLM自動統合処理対応）
- LLM自動処理API仕様
- Slack連携API仕様
- エラーハンドリング・レート制限
- Webhook仕様

## 主要な特徴

### 🚀 スピード
- 情報発信から当日〜1営業日以内での配信
- 100件程度の情報を1分程度でピックアップ可能

### 📈 ファクトベース
- 推測ではなく事実に基づく情報提供
- 幅広い情報収集による網羅性の確保

### 🎯 一覧性・視認性
- 重要度順での情報整理
- LLM自動重複排除・統合による効率的な情報管理
- 複数ソースの参考リンク一覧表示
- Slackのスレッド機能を活用した見やすい配信

### 💰 コスト効率
- サーバーレス構成によるランニングコスト最小化
- 月額5万円以内の運用コスト目標
- Phase 2まで無料プラン活用（RSS + 企業サイト + Reddit）

## 開発・運用

## 環境構築と起動

### 必須環境変数
バックエンド (`apps/backend/.env`) に以下を設定してください：

```
SLACK_BOT_TOKEN=...
OPENAI_API_KEY=...
GOOGLE_CLOUD_PROJECT=...
FIRESTORE_EMULATOR_HOST=localhost:8085   # エミュレータ利用時のみ
```

いずれかが欠けると起動時に例外終了します。

### 起動手順

1. **バックエンド起動（ローカル開発）**
   ```bash
   cd apps/backend && npm install && npm run dev
   ```
   デフォルトで `http://localhost:8080` で起動

2. **バックエンド起動（Firebase Functions エミュレータ）**
   ```bash
   cd apps/backend && npm run serve
   ```
   Firebase Functions エミュレータで起動

3. **フロントエンド起動**
   ```bash
   npm install  # 未実施なら
   npm run dev  # 既存サーバー
   ```
   `http://localhost:3001` を開きます

### 動作確認の要点

- 管理画面の Slack 設定で実ワークスペースのチャンネルが一覧表示されることを確認し、保存すると日次／週次テストボタンが有効になります
- 「テスト実行」で情報収集／レポート配信を試すと Slack に実投稿され、Slack 側のチャンネルでメッセージを確認できます。失敗時は API が 500 で落ち、delivery_logs に status: failed が残ります
- Slack モックビュー `http://localhost:3001/slack-mock/#<チャンネル名>` では最新の記事一覧のみを参照します（実際の Slack メッセージはモックでは表示されません）

### 開発環境
- Node.js 18.x
- TypeScript
- Google Cloud Functions
- Firebase CLI
- Playwright (E2Eテスト)

### 監視・アラート
- システム稼働率: 99.5%以上
- 情報収集精度: 95%以上
- 配信成功率: 99%以上
- エラー時特定ユーザーへのメンション通知

## 残作業・次ステップ

1. **Slack Bot / OpenAI / Firestore 本番クレデンシャルの共有と Secret 管理フローの確定**
2. **Playwright シナリオを実 API 前提に更新し、E2E を再整備**
3. **GitHub Actions 等で lint/test/deploy パイプラインを整備し、Firestore インデックスも含めた IaC を検討**
4. **本番環境へのデプロイ手順策定と運用監視（Cloud Logging, Alerts）の設定**

## 今後の拡張予定

### Phase 2
- より詳細な分析機能
- カスタムダッシュボード
- SPAフレームワークへの移行（React/Vue等）

### 運用規模
- **企業数**: 10社程度
- **処理件数**: 1日100件程度（取得上限500件程度）
- **ユーザー数**: 10ユーザー程度

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 連絡先

プロジェクトに関する質問や提案がございましたら、開発チームまでお気軽にお問い合わせください。

---

**作成日**: 2024年1月15日  
**バージョン**: 1.0  
**更新履歴**: 初版作成
