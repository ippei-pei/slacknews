# 001: バックエンドフル実装 要件整理

## 背景
- 競合企業ニュース自動収集・分析システムの MVP を実稼働レベルで提供する必要がある。
- 現状はフロント向け Playwright テスト用のモックのみで、実際の収集・分析・配信機能が存在しない。
- requirements.md（プロジェクトルート）に定義された要件をすべて満たす実装を行う。

## 目的
- 情報収集（RSS/公式サイト/Reddit 等）から LLM による重複排除・翻訳・要約・重要度判定・戦略分析までを自動化するバックエンドを構築する。
- Slack への日次／週次レポート配信と管理 UI からの操作を可能にする。
- 本番運用を見据えたエラー処理・監視・通知を整備する。

## スコープ
- Google Cloud Functions ベースの API / バッチ処理
- Firestore データベース設計とアクセスレイヤー
- 外部情報収集クライアント（RSS, Web クローラ, Reddit API など）
- OpenAI GPT-4 等 LLM を用いた重複統合・翻訳・要約・分析
- Slack API を用いたレポート配信
- 管理画面（別途実装予定）からバックエンド API を操作可能にするための REST エンドポイント
- 運用監視（Cloud Logging, アラート通知）

## 非スコープ（要確認）
- Phase 2 以降に予定されている Twitter/X, LinkedIn など有料 API 対応
- カスタムダッシュボードや Phase 3 の予測分析
- 既存モック UI の全面刷新（ただし必要最小限の API 連携対応は含む）

## 入力
- 監視対象企業マスタ（Firestore `companies`）
- 情報収集コンテキスト・設定情報（Firestore `settings`）
- 定期実行に必要なスケジュールトリガー（Cloud Scheduler）
- Slack OAuth 認可情報 / Bot Token（Secret Manager）
- OpenAI API Key（Secret Manager）

## 出力
- Firestore へ保存された統合済みニュース記事・分析結果
- Slack への日次／週次レポート投稿（本文 + スレッド）
- テスト実行ログ・配信実績ログ
- エラー発生時の Slack メンション通知

## 受け入れ基準
1. 要件定義書に記載された機能要件（企業管理、情報収集、AI分析、情報配信、設定・テスト実行）をすべて満たす API / バッチが提供されている。
2. データモデル設計書のコレクション構造に沿って Firestore が実装され、主要なクエリが期待どおり動作する。
3. API仕様書の I/O を満たす REST エンドポイントが実装され、OpenAPI 等でドキュメント化されている。
4. Slack への日次／週次レポートがモックではなく実データに基づき送信される。
5. 重大エラー時に設定ユーザーへメンション通知が行われ、Cloud Logging から原因を追跡できる。
6. Playwright 既存シナリオがモックではなく実 API に対して動作するよう更新され、すべてグリーンになる。
7. CI/CD パイプラインで lint/test/deploy が自動化され、手動でも再現できるドキュメントが揃っている。

