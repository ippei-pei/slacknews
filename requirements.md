# 競合企業ニュース自動収集・分析システム 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
競合企業ニュース自動収集・分析システム（Competitor News Intelligence System）

### 1.2 目的
COO実務レベルでの競合企業情報収集作業を自動化し、スピードとファクトベースの情報提供により、戦略的な意思決定を支援する。

### 1.3 達成目標
- 情報発信から当日〜1営業日以内での情報収集・配信
- ファクトオンリーの情報提供（推測は不要）
- 幅広い情報収集と見出しレベルの網羅的確認
- 100件程度の情報を1分程度でピックアップ可能な一覧性・視認性
- 重複排除による効率的な情報管理

## 2. 機能要件

### 2.1 企業管理機能

#### 2.1.1 競合企業登録
- **機能概要**: 監視対象の競合企業を登録・管理
- **詳細**:
  - 企業名（必須）
  - 企業URL（複数可）
  - RSS URL
  - SNS URL（Twitter, LinkedIn等）
  - Reddit URL
  - その他情報源URL
  - 登録日時
  - 有効/無効フラグ

#### 2.1.2 企業情報編集・削除
- 登録済み企業情報の編集
- 企業の削除（論理削除）

### 2.2 情報収集機能

#### 2.2.1 自動情報収集
- **収集対象**:
  - RSSフィード（無料・安定）
  - 企業公式サイト（無料・安定）
  - ニュースサイト（無料・安定）
  - SNS（有料プラン要検討）
    - Twitter/X: Basicプラン月額$100必要（読み取り制限あり）
    - LinkedIn: 無料プランは制限あり、有料プラン要検討
    - Reddit: 無料プランで基本的な取得可能
- **収集頻度**: 日次
- **重複除去**: LLMによる自動重複検出・除去

#### 2.2.2 情報前処理・重複排除・統合
- **本文抽出**: HTML/XMLからテキスト抽出
- **画像・動画メタデータ取得**: メディア情報の収集
- **公開日時の正規化**: タイムゾーン統一
- **言語検出**: 自動言語判定
- **LLM重複検出・統合**: AIによる類似記事検出と統合処理
  - 複数ソースの同一情報を自動検出・統合
  - 参考リンクとして全ソースを保持
  - LLMによる最適な記事内容の選択・統合

### 2.3 AI分析機能

#### 2.3.1 コンテンツ分析（LLM統合処理）
- **LLM重複検出**: GPT-4による類似記事の自動検出
- **LLM記事統合**: AIによる複数ソースの統合処理
- **LLM翻訳**: GPT-4による高品質な日本語翻訳（翻訳API不要）
  - 投稿本文はすべて日本語で統一
  - ソース情報は原文ママで保持
  - コンテキストを考慮した自然な翻訳
- **LLMサマリ生成**: 200字程度の要約（日本語）
- **LLM重要度判定**: ニュースの重要度を100点満点で評価
- **LLMカテゴリ分類**: 事業戦略、技術、人事、財務等

#### 2.3.2 戦略分析（LLM処理）
- **LLM基本戦略推定**: AIによる各企業の想定される基本戦略
- **LLM戦略変更点検出**: AIによる週次での戦略変更点の抽出
- **LLM競合比較分析**: AIによる複数企業間の比較分析

### 2.4 情報配信機能

#### 2.4.1 日次レポート
- **配信時間**: 設定可能（デフォルト：毎朝9時）
- **配信内容**:
  - **本文投稿**: 件数の端的表示 + 重要度上位10件（リンク付きテキスト）
  - **スレッド投稿**: その他のニュース（リンク付きテキスト）
  - 重要度100点満点評価（内部処理のみ・表示なし）

#### 2.4.2 週次レポート
- **配信頻度**: 毎週金曜日
- **配信内容**:
  - 各社の戦略分析（日本語）
  - 戦略変更点（日本語）
  - 週間ニュースサマリ（日本語）
  - 競合比較（日本語）
  - 自社戦略への影響シナリオ（日本語）

### 2.5 設定・管理機能

#### 2.5.1 初期設定
- **情報収集コンテキスト登録**:
  - 目的（フリーテキスト）
  - 優先順位の軸
  - 関心領域
  - 除外条件

#### 2.5.2 配信設定
- 配信チャンネル設定
- 配信時間設定
- 配信頻度設定
- 重要度フィルター設定

#### 2.5.3 LLM自動処理機能
- **システム側での自動調整**:
  - LLMによる類似記事検出（デフォルト設定）
  - 自動的な重複排除・統合処理
  - システムプロンプトの自動最適化
- **自動統合処理**:
  - システム側で定義された統合ルールによる自動処理
  - 参考リンクの自動整理
  - 統合結果の自動保存

#### 2.5.4 テスト実行機能
- LLMによる競合企業初期分析
- 情報収集結果のプレビュー
- LLM自動処理結果のプレビュー
- システム動作の確認

## 3. 非機能要件

### 3.1 性能要件
- **レスポンス時間**: 
  - 情報収集: 30分以内（日次処理）
  - LLM自動処理（重複排除・統合・翻訳・分析）: 15分以内
  - Slack投稿: 1分以内
- **スループット**: 10社分の情報を同時処理可能
- **同時接続数**: 10ユーザー程度

### 3.2 可用性要件
- **稼働率**: 99.5%以上
- **メンテナンス時間**: 月次メンテナンス（2時間以内）

### 3.3 セキュリティ要件（最低限）
- **認証**: Slack OAuth認証のみ
- **データ暗号化**: 不要（公開データのため）
- **アクセス制御**: 固定チャンネル配信のため不要
- **ログ管理**: 不要

### 3.4 スケーラビリティ要件（現状想定）
- 企業数：10社程度
- 情報量：1日100件程度（取得上限500件程度）

### 3.5 コスト要件
- **ランニングコスト**: 月額5万円以内
- **Google Cloud**: Cloud Functions等のサーバーレス構成
- **AI API**: OpenAI GPT-4の使用量最適化（翻訳API不要）
- **SNS API**: Phase 2まで（無料プラン）
  - RSS + 企業公式サイト: 無料
  - Reddit API: 無料プランで利用可能
  - Twitter/X: 後回し（Basicプラン月額$100）
  - LinkedIn: 後回し（料金未確定）

## 4. システム構成

### 4.1 アーキテクチャ概要
```
[情報源] → [収集API] → [ストレージ] → [AI分析] → [Slack配信]
   ↓           ↓           ↓          ↓         ↓
RSS/SNS    Cloud       Firestore   AI API    Slack API
Reddit     Functions               (GPT-4)
```

### 4.2 使用技術スタック
- **バックエンド**: Google Cloud Functions
- **データベース**: Firestore
- **AI分析**: OpenAI GPT-4 API
- **配信**: Slack API
- **ストレージ**: Google Cloud Storage
- **監視**: Cloud Logging

### 4.3 外部連携
- **Slack**: 投稿・認証
- **AI API**: サマリ生成・翻訳・分析（GPT-4一本化）
- **RSS API**: 情報収集（無料・安定）
- **SNS API**: 情報収集（有料プラン要検討）
  - Twitter/X: Basicプラン月額$100
  - LinkedIn: 有料プラン要検討
  - Reddit: 無料プランで利用可能

## 5. データモデル

### 5.1 主要エンティティ

#### 5.1.1 企業（Company）
```json
{
  "id": "string",
  "name": "string",
  "urls": ["string"],
  "rss_urls": ["string"],
  "sns_urls": ["string"],
  "reddit_urls": ["string"],
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "is_active": "boolean"
}
```

#### 5.1.2 ニュース記事（NewsArticle）
```json
{
  "id": "string",
  "company_id": "string",
  "title": "string",
  "content": "string",
  "url": "string",
  "published_at": "timestamp",
  "collected_at": "timestamp",
  "summary": "string",
  "summary_jp": "string",
  "importance": "number",
  "category": "string",
  "is_duplicate": "boolean"
}
```

#### 5.1.3 設定（Configuration）
```json
{
  "id": "string",
  "context": "string",
  "priority_axes": "string",
  "interests": ["string"],
  "exclude_conditions": ["string"],
  "delivery_settings": {
    "channel": "string",
    "time": "string",
    "frequency": "string"
  }
}
```

### 5.2 データベース設計
- **コレクション**: companies, news_articles, configurations, delivery_logs
- **インデックス**: published_at, company_id, importance
- **バックアップ**: 日次自動バックアップ

## 6. API仕様

### 6.1 内部API

#### 6.1.1 企業管理API
```
GET    /api/companies          # 企業一覧取得
POST   /api/companies          # 企業登録
PUT    /api/companies/:id      # 企業更新
DELETE /api/companies/:id      # 企業削除
```

#### 6.1.2 ニュース管理API
```
GET    /api/news               # ニュース一覧取得
GET    /api/news/:id           # ニュース詳細取得
POST   /api/news/collect       # 情報収集実行
```

#### 6.1.3 分析API
```
POST   /api/analyze/summary    # サマリ生成
POST   /api/analyze/strategy   # 戦略分析
POST   /api/analyze/compare    # 競合比較
```

### 6.2 Slack連携API
```
POST   /api/slack/daily        # 日次レポート配信
POST   /api/slack/weekly       # 週次レポート配信
POST   /api/slack/test         # テスト配信
```

## 7. ユーザーインターフェース

### 7.1 Slackインターフェース（標準認証）

#### 7.1.1 初期設定
```
/setup-competitor
- 企業名: [テキスト入力]
- URL: [テキスト入力]
- 目的: [テキスト入力]
```

#### 7.1.2 日次レポート形式
```
📊 競合企業ニュース (2024/01/15)

🔴 重要度: 高
• [企業名] 新サービス発表
  📝 概要: [200字サマリ]
  🔗 詳細: [スレッド]

🟡 重要度: 中
• [企業名] 人事異動
  📝 概要: [200字サマリ]
  🔗 詳細: [スレッド]
```

#### 7.1.3 週次レポート形式
```
📈 週次戦略分析レポート (第2週)

🏢 [企業A]
• 基本戦略: [戦略概要]
• 変更点: [今週の変更]
• ニュースサマリ: [週間ハイライト]

🏢 [企業B]
• 基本戦略: [戦略概要]
• 変更点: [今週の変更]
• ニュースサマリ: [週間ハイライト]

💡 自社戦略への影響
[影響シナリオ分析]
```

### 7.2 Web管理画面（Slack認証のみ）
- **認証**: Slack OAuth認証のみ
- **機能**: 
  - 企業管理（登録・編集・削除・一覧表示）
  - テスト実行機能（情報取得・配信テスト）
  - エラー通知対象ユーザー設定
- **アクセス**: 固定チャンネル配信のため、チャンネル制限不要
- **権限**: 管理者権限とユーザー権限の切り分けなし

## 8. 運用要件

### 8.1 監視・アラート
- 情報収集失敗時のアラート（特定ユーザーにメンション）
- AI分析エラー時の通知（特定ユーザーにメンション）
- Slack配信失敗時の再試行
- システム稼働状況の監視
- **運用体制**: ベンダーによるシステム管理・メンテナンス

### 8.2 データ保持期間
- **記事データ**: 1ヶ月間保持
- **週次レポート**: 半年間保持

### 8.3 バックアップ・復旧（最小限）
- 週次データバックアップ
- 設定情報のバックアップ

## 9. セキュリティ要件（最小限）

### 9.1 認証・認可
- Slack OAuth認証のみ
- 固定チャンネル配信のため、チャンネル制限不要
- API キーの基本管理

### 9.2 データ保護
- 公開データのため、暗号化不要
- 個人情報は収集しない

### 9.3 API キー管理
- **Slack API キー**: SecretManagerで管理
- **OpenAI API キー**: SecretManagerで管理
- **管理画面**: API キーを露出させない

### 9.4 セキュリティ監視（最小限）
- 基本的なエラー監視のみ

## 10. 開発・テスト要件

### 10.1 開発環境
- ローカル開発環境の構築
- テスト用Slackワークスペース
- モックデータの準備

### 10.2 テスト要件
- 単体テスト（カバレッジ80%以上）
- 統合テスト
- 負荷テスト
- セキュリティテスト

### 10.3 デプロイメント
- CI/CDパイプライン
- ステージング環境
- 本番環境への自動デプロイ

## 11. 今後の拡張性

### 11.1 Phase 2機能
- 多言語対応の拡張
- より詳細な分析機能
- カスタムダッシュボード
- API公開

### 11.2 Phase 3機能
- 機械学習による予測分析
- 他ツールとの連携（Salesforce等）
- モバイルアプリ
- リアルタイム通知

## 12. SNS API要件・コスト分析

### 12.1 Twitter/X API
- **無料プラン**: 読み取り制限あり、実用的ではない
- **Basicプラン**: 月額$100（約1.5万円）
  - 月間3,000ポスト投稿、10,000ポスト読み取り
  - 企業監視には十分な制限
- **推奨**: 初期は無料プランで試用、必要に応じてBasicプラン検討

### 12.2 LinkedIn API
- **無料プラン**: 制限あり、企業データ取得は困難
- **有料プラン**: 料金体系要調査
- **推奨**: RSSフィードや公式サイトを優先、LinkedInは後回し

### 12.3 Reddit API
- **無料プラン**: 基本的な取得可能
- **Rate Limit**: 60 requests/minute
- **推奨**: 無料プランで利用開始

### 12.4 実装方針（確定）
1. **Phase 1**: RSSフィード + 企業公式サイト（無料・安定）
2. **Phase 2**: Reddit API（無料プラン）
3. **Phase 3**: Twitter/X API（後回し・有料プラン月額$100）
4. **Phase 4**: LinkedIn API（後回し・料金未確定）

## 13. リスク・制約事項

### 13.1 技術的リスク
- AI APIの利用制限
- 外部APIの変更・廃止
- 情報源の構造変更

### 13.2 運用リスク
- 情報収集の精度
- 誤情報の配信
- システムダウンタイム

### 13.3 コストリスク
- SNS API有料プランの料金変動
- AI API使用量の予想以上の増加

### 13.4 法的リスク
- 著作権問題
- データ保護法の遵守
- 利用規約の変更

## 14. 成功指標（KPI）

### 14.1 定量的指標
- 情報収集精度: 95%以上
- 配信成功率: 99%以上
- ユーザー満足度: 4.0/5.0以上
- システム稼働率: 99.5%以上

### 14.2 定性的指標
- 意思決定のスピード向上
- 情報の網羅性向上
- 作業効率の改善
- 戦略的洞察の向上

---

**作成日**: 2024年1月15日  
**バージョン**: 1.0  
**作成者**: AI Assistant
